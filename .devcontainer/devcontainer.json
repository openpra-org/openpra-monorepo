{
  "name": "openpra-monorepo-dev",
  "build": {
    "dockerfile": "Dockerfile"
  },
  "features": {
    "ghcr.io/devcontainers/features/desktop-lite:1": {},
    "ghcr.io/devcontainers/features/rust:1": {}
  },
  "containerEnv": {
    "DISPLAY": ""
  },
  "overrideCommand": false,
  "privileged": true,
  "mounts": [
    {
      "source": "vscode-dev",
      "target": "/vscode-dev",
      "type": "volume"
    }
  ],
  "postCreateCommand": "./.devcontainer/post-create.sh",
  "customizations": {
    "vscode": {
      "settings": {
        "resmon.show.battery": false,
        "resmon.show.cpufreq": false
      },
      "extensions": [
        "dbaeumer.vscode-eslint",
        "EditorConfig.EditorConfig",
        "GitHub.vscode-pull-request-github",
        "ms-vscode.vscode-github-issue-notebooks",
        "ms-vscode.vscode-selfhost-test-provider",
        "mutantdino.resourcemonitor"
      ]
    }
  },
  "forwardPorts": [27017, 5672, 15672, 4200, 3000, 8000],
  "portsAttributes": {
    "27017": { "label": "MongoDB", "onAutoForward": "silent" },
    "5672": { "label": "RabbitMQ AMQP", "onAutoForward": "silent" },
    "15672": { "label": "RabbitMQ Management", "onAutoForward": "silent" },
    "4200": { "label": "Frontend", "onAutoForward": "silent" },
    "3000": { "label": "Job Broker", "onAutoForward": "silent" },
    "8000": { "label": "Backend", "onAutoForward": "silent" }
  },
  "hostRequirements": {
    "memory": "8gb", // RAM options: 4, 8, 16, 32 GB
    "cpus": 4, // vCPUs options: 2, 4, 8, 16, 32
    "storage": "32gb" // Storage options: 32, 64, 128 GB
  },
  "services": {
    "mongodb": {
      "image": "mongo:6",
      "restart": "unless-stopped",
      "ports": [ "27017:27017" ],
      "volumes": [ "mongodb-data:/data/db" ]
    },
    "rabbitmq": {
      "image": "rabbitmq:management-alpine",
      "restart": "unless-stopped",
      "ports": [ "5672:5672", "15672:15672" ],
      "volumes": [ "rabbitmq-data:/var/lib/rabbitmq" ]
    }
  },
  "volumes": {
    "mongodb-data": {},
    "rabbitmq-data": {}
  },
  "updateContentCommand": "pnpm install"
}
